<?xml version="1.0" encoding="UTF-8"?>
<!--<?xml-model href="file:../5.1/dbref.rnc" type="application/relax-ng-compact-syntax"?>-->
<topic xml:id="dbc.structure.revision-list"
   xmlns="http://docbook.org/ns/docbook"
   xmlns:xi="http://www.w3.org/2001/XInclude"
   xmlns:xlink="http://www.w3.org/1999/xlink">
  <title>Including Revision Information from Version Control Systems</title>
  <info>
    <definitions definitionfile="defs.xml"/>
  </info>
  
  <section role="problem">
    <title>Problem</title>
    <para>You want to include revision information into your DocBook
      document from your version control systems, like Subversion,
      Mercurial, Git, etc.</para>
  </section>
  <section role="solution">
    <title>Solution</title>
    <para>Usually, the solution for each version control system is to
      output its log into its specific XML output and transform it with
      XSLT into a <tag>revhistory</tag> element. </para>
    
    <section>
      <title>Bazaar</title>
      <para><application xlink:href="http://bazaar.canonical.com">Bazaar</application></para>
    </section>
    <section>
      <title>Git</title>
      <para>TBD</para>
    </section>
    <section>
      <title>Mercurial</title>
      <para><application
        xlink:href="http://mercurial.selenic.com">Mercurial</application>
        has the option <option>--style</option> to output its log into
        XML:</para>
      <screen><command>hg</command> log --style xml > log.xml</screen>
      <para>The XML file of the Mercurial log looks like this:</para>
      <example>
        <title>Mercurial Log File in XML</title>
        <programlisting linenumbering="numbered" language="xml">&lt;log>
  &lt;logentry revision="69"
    node="dfadd024594c4083362fe6919264362803dcd285">
    &lt;tag>tip&lt;/tag>
    &lt;author email="tux@example.de">Tux Penguin&lt;/author>
    &lt;date>2011-05-22T01:56:21+02:00&lt;/date>
    &lt;msg xml:space="preserve">Corrected xml:id attribute&lt;/msg>
    &lt;paths>
      &lt;path action="M">xml/structure/topic.extract-element.xml&lt;/path>
    &lt;/paths>
  &lt;/logentry>
  &lt;logentry revision="68"
    node="833287df8943d0bab5ec65ec8aafe5bc42002289">
    &lt;author email="wilber@example.de">Wilber Gimp&lt;/author>
    &lt;date>2011-05-22T01:56:03+02:00&lt;/date>
    &lt;msg xml:space="preserve">Changed chapter title&lt;/msg>
    &lt;paths>
      &lt;path action="M">xml/structure/topic.revision-list.xml&lt;/path>
    &lt;/paths>
  &lt;/logentry>
  &lt;!-- Many more entries ... -->
&lt;/log</programlisting>
      </example>
      <para>With </para>
      <example xml:id="ex.hg2revhistory.xsl">
        <title>Stylesheet <filename>hg2revhistory.xsl</filename> to Convert Mercurial XML Log Files into
          DocBook's <tag>revhistory</tag></title>
        <titleabbrev><filename>hg2revhistory.xsl</filename></titleabbrev>
        <programlisting linenumbering="numbered" language="xml"
          ><xi:include href="xslt/hg2revhistory.xsl" parse="text"
          /></programlisting>
      </example>
    </section>
    <section>
      <title>Subversion</title>
      <para><application
        xlink:href="http://subversion.tigris.org">Subversion</application>
        is similar like Mercurial: It has an option
        <option>--xml</option> to turn the log output into XML:</para>
      <screen><command>svn</command> log --xml</screen>
      <para>With the option <option>-v</option> (verbose) you get
        additional path informations. As the output is very similar to
        Mercurial, you can apply the stylesheet shown in <xref linkend="ex.hg2revhistory.xsl"/>
        also for Subversion's log file.
      </para>
      <para>As an alternative, the DocBook Subversion repository (see
          <link
          xlink:href="https://docbook.svn.sourceforge.net/svnroot/docbook/trunk"
        />) contains the XSLT stylesheet
          <filename>releasetools/svnlog2docbook.xsl</filename> with
        additional features.</para>
    </section>    
  </section>
  <section role="discussion">
    <title>Discussion</title>
    <para>Some discussion about problem and solution.</para>
  </section>
  <!--<section role="seealso">
    <title>See Also</title>
    <para></para>
  </section>-->
</topic>
